ä¸€ã€è¡¥å……çŸ¥è¯†ï¼šhttpè¯·æ±‚å¤´å“åº”å¤´ï¼Œå„æ–¹åä½œå…³ç³»
![image](https://github.com/user-attachments/assets/d54f3a59-a58f-45d2-809d-cc69176374ea)
åœ¨ä¸€ä¸ªHTTPè¯·æ±‚ä¸­ï¼Œä¸€èˆ¬å¯ä»¥æŠŠä¸Šä¼ å‚æ•°åˆ†ä¸ºä»¥ä¸‹ä¸‰ä¸ªéƒ¨åˆ†ï¼š
1.Header
2.URL  
eg:/user/:id   
     id := ctx.Param("id")
3.HTTP Body

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æµè§ˆå™¨/å®¢æˆ·ç«¯ â”‚â”€â”€Requestâ”€â”€â–¶â”‚ Gin HTTP æœåŠ¡å™¨æ§åˆ¶å™¨ â”‚â”€â”€Responseâ”€â”€â–¶â”‚ æµè§ˆå™¨/å®¢æˆ·ç«¯ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â–²                                                       â–¼
    è¯·æ±‚å¤´ï¼ˆAccept, Range, etcï¼‰                        å“åº”å¤´ï¼ˆContent-Type, etcï¼‰

Requestï¼š
GET /image?id=1 HTTP/1.1
Host: localhost:8080
Accept: image/avif,image/webp,image/apng,*/*
Range: bytes=0-999

Gin codingï¼ˆphoto-serviceï¼‰:
```
ctx.Header("Content-Type", "image/jpeg")
ctx.Header("Content-Disposition", "inline; filename=\"cat.jpg\"")
ctx.Header("Accept-Ranges", "bytes")

http.ServeContent(ctx.Writer, ctx.Request, filename, time.Now(), bytes.NewReader(imageBytes))
```
response:
| å“åº”å¤´                                          | æµè§ˆå™¨è¡Œä¸º         |
| -------------------------------------------- | ------------- |
| `Content-Type: image/jpeg`                   | ğŸ‘€ æ˜¾ç¤ºä¸ºå›¾ç‰‡      |
| `Content-Disposition: inline`                | âœ… é¡µé¢ä¸­å±•ç¤ºï¼ˆä¸æ˜¯ä¸‹è½½ï¼‰ |
| `Accept-Ranges: bytes`                       | âœ… æœªæ¥å¯è¯·æ±‚æŸæ®µèŒƒå›´   |
| `Content-Length: 93212`                      | ğŸ“ çŸ¥é“å›¾ç‰‡å¤§å°     |
| `Cache-Control`, `ETag`, `Last-Modified`ï¼ˆå¯é€‰ï¼‰ | ğŸ§  æµè§ˆå™¨åˆ¤æ–­æ˜¯å¦ç¼“å­˜  |

å³å½“ï¼š
curl -I http://localhost:8080//decrypt?id=1
æµè§ˆå™¨è¡Œä¸ºï¼š
Â·å‘é€è¯·æ±‚å¤´ï¼šAccept: image/*
Â·æ¥æ”¶åˆ°å“åº”å¤´ï¼š
  Â· Content-Type æ˜¯å›¾ç‰‡ â†’ ç›´æ¥å±•ç¤º

  | è§’è‰²               | è¡Œä¸º          | å®ç°ä»£ç ç‰‡æ®µ                                     |
| ---------------- | ----------- | ------------------------------------------ |
| **å®¢æˆ·ç«¯ / æµè§ˆå™¨**    | å‘å‡ºå¸¦è¯·æ±‚å¤´çš„è¯·æ±‚   | `curl -I` / `<img src=...>`                |
| **Gin æ§åˆ¶å™¨**      | è¯»å–è¯·æ±‚å¤´ï¼Œè®¾ç½®å“åº”å¤´ | `ctx.Request.Header`, `ctx.Header(...)`    |
| **Gin / Go æ ‡å‡†åº“** | æ ¹æ®å“åº”å¤´è¿”å›å†…å®¹   | `ctx.Data(...)` / `http.ServeContent(...)` |
| **å®¢æˆ·ç«¯ / æµè§ˆå™¨**    | æ ¹æ®å“åº”å¤´å¤„ç†è¿”å›   | æ¸²æŸ“ / ä¸‹è½½ / åˆ†æ®µåŠ è½½                             |




äºŒã€è¦æ±‚ï¼šåŠ å¯†å¤„ç†ï¼Œå›¾ç‰‡ä¸èƒ½ç›´æ¥æš´éœ²æ–‡ä»¶è·¯å¾„
ï¼é€šè¿‡åç«¯ åŠ¨æ€å“åº”å›¾ç‰‡å†…å®¹
HTTP å“åº”å¤´çš„ä½œç”¨ï¼šå‘Šè¯‰æµè§ˆå™¨ï¼Œâ€œæˆ‘è¿”å›çš„æ˜¯ä¸€ä¸ªä»€ä¹ˆç±»å‹çš„èµ„æºï¼Œä½ åº”è¯¥å¦‚ä½•å¤„ç†å®ƒã€‚â€
Gin çš„å“åº”å¤´ï¼š

ctx.Header(key, value)

| å“åº”å¤´                   | ä½œç”¨                             |
| --------------------- | ------------------------------ |
| `Content-Type`        | å‘Šè¯‰æµè§ˆå™¨è¿”å›çš„æ•°æ®æ˜¯ä»€ä¹ˆæ ¼å¼ï¼ˆå›¾ç‰‡ã€æ–‡æœ¬ã€JSON...ï¼‰ |
| `Content-Length`      | è¡¨ç¤ºèµ„æºå¤§å°ï¼ˆå¯é€‰ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨åŠ ï¼‰              |
| `Content-Disposition` | å‘Šè¯‰æµè§ˆå™¨æ˜¯å±•ç¤ºè¿˜æ˜¯ä¸‹è½½                   |
| `Accept-Ranges`       | å‘Šè¯‰å®¢æˆ·ç«¯æ˜¯å¦æ”¯æŒâ€œåˆ†æ®µè¯·æ±‚â€ï¼ˆæ–­ç‚¹ç»­ä¼ ï¼‰          |

http.ServeContentæ ‡å‡†åº“ï¼š

mime ç±»å‹æ£€æµ‹
æ­£ç¡®å¤„ç† HTTP Range è¯·æ±‚å¤´ã€‚  è¯·æ±‚æ–‡ä»¶çš„ä¸€éƒ¨åˆ†

ServeContent çš„çµæ´»æ€§ã€‚å³ä½¿å†…å®¹ä¸åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œåªè¦ä½ èƒ½æŠŠå®ƒåŒ…è£…æˆ io.ReadSeeker
å°±èƒ½äº«å—åˆ° ServeContent å¸¦æ¥çš„æ‰€æœ‰å¥½å¤„ã€‚

egï¼š
```
// è®¾ç½®å“åº”å¤´ï¼ˆç±»å‹å¯æ ¹æ®æ–‡ä»¶ååç¼€åŠ¨æ€åˆ¤æ–­,è‡ªåŠ¨è¯†åˆ«ï¼‰
	contentType := mime.TypeByExtension(filepath.Ext(filename))  
	if contentType == "" {
		contentType = "application/octet-stream"
	}
//å“åº”å¤´å®é™…åœ¨è¿™é‡Œ
	ctx.Header("Content-Type", contentType)
	ctx.Header("Content-Disposition", "inline; filename=\""+filename+"\"")  //è½¬ä¹‰åŒå¼•å·\"
 //inline æ˜¾ç¤º    attachment å¼¹å‡ºå¯¹è¯æ¡†ä¸‹è½½
	ctx.Header("Accept-Ranges", "bytes")  //å¯ç”¨ æ”¯æŒæ–­ç‚¹ç»­ä¼ ã€åˆ†æ®µä¸‹è½½ï¼ˆRange è¯·æ±‚ï¼‰
	// åˆ¤æ–­æ˜¯å¦HEAD è¯·æ±‚
	if ctx.Request.Method == http.MethodHead {
		ctx.Status(200)
		return
	}

//å¦‚æœå®¢æˆ·ç«¯å‘çš„æ˜¯ HEAD è¯·æ±‚ï¼Œæˆ‘ä»¬åªè¿”å›ã€Œå“åº”å¤´ã€ï¼Œä¸è¿”å›ä»»ä½•å†…å®¹
//HEAD ç”¨äºæ£€æŸ¥èµ„æºå­˜åœ¨ä¸å¦ã€è·å–èµ„æºå¤§å°ç­‰

	// æ”¯æŒ Range è¯·æ±‚ï¼Œè¿™é‡Œæ‰è¿”å›å®é™…å†…å®¹
	http.ServeContent(ctx.Writer, ctx.Request, filename, time.Now(), bytes.NewReader(imageData))
```

content io.ReadSeeker ï¼šè¦æ”¯æŒ èŒƒå›´è¯·æ±‚ (Range Requests)ã€‚å½“å®¢æˆ·ç«¯è¯·æ±‚æ–‡ä»¶çš„ä¸€ä¸ªç‰‡æ®µæ—¶ï¼ŒServeContent å¿…é¡»èƒ½å¤Ÿé€šè¿‡ Seek æ–¹æ³•å°†è¯»å–æŒ‡é’ˆç§»åŠ¨åˆ°æŒ‡å®šçš„å­—èŠ‚åç§»é‡ï¼Œç„¶åå†å¼€å§‹é€šè¿‡ Read æ–¹æ³•è¯»å–æ•°æ®ã€‚
å¸¸è§å®ç°æ–¹æ³•æœ‰ï¼š*os.File=os.Open(filePath)  *bytes.Reader=bytes.NewReader(data)  *strings.Reader=strings.NewReader(s)



curl -I http://localhost:8080//decrypt?id=1
